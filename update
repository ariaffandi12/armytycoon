local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer

-- Create GUI Elements
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TopBar = Instance.new("Frame")
local TitleLabel = Instance.new("TextLabel")
local CreatorLabel = Instance.new("TextLabel")
local MinimizeButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local ContentFrame = Instance.new("Frame")
local MinimizedFrame = Instance.new("Frame")
local RestoreButton = Instance.new("TextButton")

-- Player Selection Dropdown
local PlayerFrame = Instance.new("Frame")
local PlayerLabel = Instance.new("TextLabel")
local PlayerDropdown = Instance.new("TextButton")
local PlayerList = Instance.new("ScrollingFrame")

-- Button Frames
local ButtonFrame1 = Instance.new("Frame")
local ButtonFrame2 = Instance.new("Frame")

-- Main Buttons
local KillAllUnitsButton = Instance.new("TextButton")
local GetAllBuildingsButton = Instance.new("TextButton")
local AutoRebirthButton = Instance.new("TextButton")
local NukePlayerButton = Instance.new("TextButton")
local KillPlayerUnitsButton = Instance.new("TextButton")
local NukeMouseButton = Instance.new("TextButton")
local X4UnitsButton = Instance.new("TextButton")
local MoreUnit100Button = Instance.new("TextButton")
local NukeAllBasesButton = Instance.new("TextButton")

-- Variables
local selectedPlayer = nil
local autoRebirthEnabled = false
local playerDropdownOpen = false
local x4UnitsEnabled = false
local isSpawning100Units = false

-- Setup ScreenGui
ScreenGui.Name = "DeveloperGUI"
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

-- Main Frame Setup with Modern Gradient
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.3, 0, 0.25, 0)
MainFrame.Size = UDim2.new(0, 380, 0, 520)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

-- Add modern gradient background
local MainGradient = Instance.new("UIGradient")
MainGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(20, 25, 35)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 15, 25))
}
MainGradient.Rotation = 45
MainGradient.Parent = MainFrame

-- Add modern border glow effect
local MainStroke = Instance.new("UIStroke")
MainStroke.Color = Color3.fromRGB(100, 150, 255)
MainStroke.Thickness = 2
MainStroke.Transparency = 0.3
MainStroke.Parent = MainFrame

-- Add rounded corners to main frame
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 16)
MainCorner.Parent = MainFrame

-- Enhanced Dragging for MainFrame
local function makeDraggable(frame)
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
        end
    end)
    
    frame.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    frame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
end

-- Apply enhanced dragging
makeDraggable(MainFrame)

-- Top Bar with Modern Design
TopBar.Name = "TopBar"
TopBar.Parent = MainFrame
TopBar.BackgroundColor3 = Color3.fromRGB(25, 30, 40)
TopBar.BorderSizePixel = 0
TopBar.Size = UDim2.new(1, 0, 0, 45)

-- Add gradient to top bar
local TopGradient = Instance.new("UIGradient")
TopGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 35, 50)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 25, 35))
}
TopGradient.Rotation = 90
TopGradient.Parent = TopBar

local TopCorner = Instance.new("UICorner")
TopCorner.CornerRadius = UDim.new(0, 16)
TopCorner.Parent = TopBar

-- Title Label with Modern Typography
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = TopBar
TitleLabel.BackgroundTransparency = 1
TitleLabel.Position = UDim2.new(0, 15, 0, 5)
TitleLabel.Size = UDim2.new(1, -100, 0, 25)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "💻 Developer"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 16
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Creator Label
CreatorLabel.Name = "CreatorLabel"
CreatorLabel.Parent = TopBar
CreatorLabel.BackgroundTransparency = 1
CreatorLabel.Position = UDim2.new(0, 15, 0, 25)
CreatorLabel.Size = UDim2.new(1, -100, 0, 15)
CreatorLabel.Font = Enum.Font.Gotham
CreatorLabel.Text = "by @riee"
CreatorLabel.TextColor3 = Color3.fromRGB(100, 150, 255)
CreatorLabel.TextSize = 12
CreatorLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Modern Minimize Button
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Parent = TopBar
MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 193, 7)
MinimizeButton.BorderSizePixel = 0
MinimizeButton.Position = UDim2.new(1, -75, 0, 8)
MinimizeButton.Size = UDim2.new(0, 30, 0, 30)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.Text = "−"
MinimizeButton.TextColor3 = Color3.fromRGB(0, 0, 0)
MinimizeButton.TextSize = 20

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 8)
MinCorner.Parent = MinimizeButton

-- Add hover effect
local MinStroke = Instance.new("UIStroke")
MinStroke.Color = Color3.fromRGB(255, 255, 255)
MinStroke.Thickness = 1
MinStroke.Transparency = 0.8
MinStroke.Parent = MinimizeButton

-- Modern Close Button
CloseButton.Name = "CloseButton"
CloseButton.Parent = TopBar
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 69, 58)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(1, -40, 0, 8)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "✕"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 16

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 8)
CloseCorner.Parent = CloseButton

-- Add hover effect
local CloseStroke = Instance.new("UIStroke")
CloseStroke.Color = Color3.fromRGB(255, 255, 255)
CloseStroke.Thickness = 1
CloseStroke.Transparency = 0.8
CloseStroke.Parent = CloseButton

-- Content Frame
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundTransparency = 1
ContentFrame.Position = UDim2.new(0, 0, 0, 45)
ContentFrame.Size = UDim2.new(1, 0, 1, -45)

-- Modern Player Selection Frame
PlayerFrame.Name = "PlayerFrame"
PlayerFrame.Parent = ContentFrame
PlayerFrame.BackgroundColor3 = Color3.fromRGB(25, 30, 40)
PlayerFrame.BorderSizePixel = 0
PlayerFrame.Position = UDim2.new(0, 15, 0, 15)
PlayerFrame.Size = UDim2.new(1, -30, 0, 70)

-- Add gradient to player frame
local PlayerGradient = Instance.new("UIGradient")
PlayerGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 35, 50)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 25, 35))
}
PlayerGradient.Rotation = 45
PlayerGradient.Parent = PlayerFrame

local PlayerCorner = Instance.new("UICorner")
PlayerCorner.CornerRadius = UDim.new(0, 12)
PlayerCorner.Parent = PlayerFrame

-- Add modern border
local PlayerStroke = Instance.new("UIStroke")
PlayerStroke.Color = Color3.fromRGB(60, 70, 90)
PlayerStroke.Thickness = 1
PlayerStroke.Transparency = 0.5
PlayerStroke.Parent = PlayerFrame

PlayerLabel.Name = "PlayerLabel"
PlayerLabel.Parent = PlayerFrame
PlayerLabel.BackgroundTransparency = 1
PlayerLabel.Position = UDim2.new(0, 15, 0, 8)
PlayerLabel.Size = UDim2.new(1, -30, 0, 20)
PlayerLabel.Font = Enum.Font.GothamSemibold
PlayerLabel.Text = "🎯 Select Target Player:"
PlayerLabel.TextColor3 = Color3.fromRGB(200, 220, 255)
PlayerLabel.TextSize = 13
PlayerLabel.TextXAlignment = Enum.TextXAlignment.Left

PlayerDropdown.Name = "PlayerDropdown"
PlayerDropdown.Parent = PlayerFrame
PlayerDropdown.BackgroundColor3 = Color3.fromRGB(40, 45, 60)
PlayerDropdown.BorderSizePixel = 0
PlayerDropdown.Position = UDim2.new(0, 15, 0, 35)
PlayerDropdown.Size = UDim2.new(1, -30, 0, 25)
PlayerDropdown.Font = Enum.Font.Gotham
PlayerDropdown.Text = "Click to select player ▼"
PlayerDropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerDropdown.TextSize = 12

local DropdownCorner = Instance.new("UICorner")
DropdownCorner.CornerRadius = UDim.new(0, 6)
DropdownCorner.Parent = PlayerDropdown

-- Player List with modern styling
PlayerList.Name = "PlayerList"
PlayerList.Parent = ScreenGui
PlayerList.BackgroundColor3 = Color3.fromRGB(25, 30, 40)
PlayerList.BorderSizePixel = 0
PlayerList.Position = UDim2.new(0.3, 35, 0.25, 140)
PlayerList.Size = UDim2.new(0, 330, 0, 160)
PlayerList.Visible = false
PlayerList.ScrollBarThickness = 6
PlayerList.CanvasSize = UDim2.new(0, 0, 0, 0)
PlayerList.Active = true

-- Apply enhanced dragging to PlayerList
makeDraggable(PlayerList)

local ListCorner = Instance.new("UICorner")
ListCorner.CornerRadius = UDim.new(0, 12)
ListCorner.Parent = PlayerList

-- Add modern border to list
local ListStroke = Instance.new("UIStroke")
ListStroke.Color = Color3.fromRGB(100, 150, 255)
ListStroke.Thickness = 2
ListStroke.Transparency = 0.3
ListStroke.Parent = PlayerList

local ListLayout = Instance.new("UIListLayout")
ListLayout.Parent = PlayerList
ListLayout.SortOrder = Enum.SortOrder.Name
ListLayout.Padding = UDim.new(0, 3)

-- Button Frames
ButtonFrame1.Name = "ButtonFrame1"
ButtonFrame1.Parent = ContentFrame
ButtonFrame1.BackgroundTransparency = 1
ButtonFrame1.Position = UDim2.new(0, 15, 0, 95)
ButtonFrame1.Size = UDim2.new(1, -30, 0, 315)

ButtonFrame2.Name = "ButtonFrame2"
ButtonFrame2.Parent = ContentFrame
ButtonFrame2.BackgroundTransparency = 1
ButtonFrame2.Position = UDim2.new(0, 15, 0, 365)
ButtonFrame2.Size = UDim2.new(1, -30, 0, 120)

-- Function to create modern styled buttons
local function createButton(name, parent, position, size, text, color)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Parent = parent
    button.BackgroundColor3 = color
    button.BorderSizePixel = 0
    button.Position = position
    button.Size = size
    button.Font = Enum.Font.GothamSemibold
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 12
    button.TextWrapped = true
    
    -- Add modern corner radius
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = button
    
    -- Add modern gradient
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, color),
        ColorSequenceKeypoint.new(1, Color3.new(color.R * 0.8, color.G * 0.8, color.B * 0.8))
    }
    gradient.Rotation = 45
    gradient.Parent = button
    
    -- Add modern border
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(255, 255, 255)
    stroke.Thickness = 1
    stroke.Transparency = 0.8
    stroke.Parent = button
    
    -- Add hover effect
    button.MouseEnter:Connect(function()
        stroke.Transparency = 0.5
        TweenService:Create(button, TweenInfo.new(0.2), {Size = UDim2.new(size.X.Scale + 0.01, size.X.Offset, size.Y.Scale + 0.01, size.Y.Offset)}):Play()
    end)
    
    button.MouseLeave:Connect(function()
        stroke.Transparency = 0.8
        TweenService:Create(button, TweenInfo.new(0.2), {Size = size}):Play()
    end)
    
    return button
end

-- Create Modern Buttons
KillAllUnitsButton = createButton("KillAllUnitsButton", ButtonFrame1, UDim2.new(0, 0, 0, 0), UDim2.new(0.48, 0, 0, 45), "💀 Kill All Units", Color3.fromRGB(255, 59, 48))
GetAllBuildingsButton = createButton("GetAllBuildingsButton", ButtonFrame1, UDim2.new(0.52, 0, 0, 0), UDim2.new(0.48, 0, 0, 45), "🏗️ Get All Buildings", Color3.fromRGB(52, 199, 89))
AutoRebirthButton = createButton("AutoRebirthButton", ButtonFrame1, UDim2.new(0, 0, 0, 55), UDim2.new(0.48, 0, 0, 45), "🔄 Auto Rebirth: OFF", Color3.fromRGB(142, 142, 147))
NukePlayerButton = createButton("NukePlayerButton", ButtonFrame1, UDim2.new(0.52, 0, 0, 55), UDim2.new(0.48, 0, 0, 45), "☢️ Nuke Player", Color3.fromRGB(255, 204, 0))
KillPlayerUnitsButton = createButton("KillPlayerUnitsButton", ButtonFrame1, UDim2.new(0, 0, 0, 110), UDim2.new(0.48, 0, 0, 45), "⚔️ Kill Player Units", Color3.fromRGB(255, 59, 48))
NukeMouseButton = createButton("NukeMouseButton", ButtonFrame1, UDim2.new(0.52, 0, 0, 110), UDim2.new(0.48, 0, 0, 45), "🎯 Nuke Mouse (Q)", Color3.fromRGB(255, 149, 0))
X4UnitsButton = createButton("X4UnitsButton", ButtonFrame1, UDim2.new(0, 0, 0, 165), UDim2.new(0.48, 0, 0, 45), "⚡ x4 Units: OFF", Color3.fromRGB(175, 82, 222))
MoreUnit100Button = createButton("MoreUnit100Button", ButtonFrame1, UDim2.new(0.52, 0, 0, 165), UDim2.new(0.48, 0, 0, 45), "🔥 More Unit +100", Color3.fromRGB(255, 45, 85))
NukeAllBasesButton = createButton("NukeAllBasesButton", ButtonFrame1, UDim2.new(0, 0, 0, 220), UDim2.new(1, 0, 0, 45), "💥 Nuke All Player Bases", Color3.fromRGB(255, 20, 20))

-- Modern Status Label
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = ButtonFrame1
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0, 0, 0, 275)
StatusLabel.Size = UDim2.new(1, 0, 0, 35)
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.Text = "✅ Ready to spawn units"
StatusLabel.TextColor3 = Color3.fromRGB(52, 199, 89)
StatusLabel.TextSize = 13
StatusLabel.TextXAlignment = Enum.TextXAlignment.Center

-- Modern Minimized Frame
MinimizedFrame.Name = "MinimizedFrame"
MinimizedFrame.Parent = ScreenGui
MinimizedFrame.BackgroundColor3 = Color3.fromRGB(25, 30, 40)
MinimizedFrame.BorderSizePixel = 0
MinimizedFrame.Position = UDim2.new(0, 15, 0.5, -20)
MinimizedFrame.Size = UDim2.new(0, 140, 0, 40)
MinimizedFrame.Visible = false
MinimizedFrame.Active = true

-- Apply enhanced dragging to MinimizedFrame
makeDraggable(MinimizedFrame)

local MinFrameCorner = Instance.new("UICorner")
MinFrameCorner.CornerRadius = UDim.new(0, 12)
MinFrameCorner.Parent = MinimizedFrame

-- Add modern border to minimized frame
local MinFrameStroke = Instance.new("UIStroke")
MinFrameStroke.Color = Color3.fromRGB(100, 150, 255)
MinFrameStroke.Thickness = 2
MinFrameStroke.Transparency = 0.3
MinFrameStroke.Parent = MinimizedFrame

RestoreButton.Name = "RestoreButton"
RestoreButton.Parent = MinimizedFrame
RestoreButton.BackgroundTransparency = 1
RestoreButton.Size = UDim2.new(1, 0, 1, 0)
RestoreButton.Font = Enum.Font.GothamSemibold
RestoreButton.Text = "💻 Developer by @riee"
RestoreButton.TextColor3 = Color3.fromRGB(255, 255, 255)
RestoreButton.TextSize = 12

-- Helper Functions
local function updatePlayerList()
    -- Clear existing players
    for _, child in pairs(PlayerList:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    local yPos = 0
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local playerButton = Instance.new("TextButton")
            playerButton.Name = player.Name
            playerButton.Parent = PlayerList
            playerButton.BackgroundColor3 = Color3.fromRGB(40, 45, 60)
            playerButton.BorderSizePixel = 0
            playerButton.Position = UDim2.new(0, 8, 0, yPos)
            playerButton.Size = UDim2.new(1, -16, 0, 28)
            playerButton.Font = Enum.Font.Gotham
            playerButton.Text = player.Name
            playerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            playerButton.TextSize = 12
            
            local btnCorner = Instance.new("UICorner")
            btnCorner.CornerRadius = UDim.new(0, 6)
            btnCorner.Parent = playerButton
            
            playerButton.MouseButton1Click:Connect(function()
                selectedPlayer = player
                PlayerDropdown.Text = "Selected: " .. player.Name
                PlayerList.Visible = false
                playerDropdownOpen = false
            end)
            
            yPos = yPos + 31
        end
    end
    
    PlayerList.CanvasSize = UDim2.new(0, 0, 0, yPos)
end

local function getAllBuildings()
    for i,v in pairs(game.Workspace.Game.Buttons:GetChildren()) do
        if v.Name == LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                ReplicatedStorage.RE.relinquish:FireServer(v2, true)
            end
        end
    end
    
    wait(0.1)
    
    for i,v in pairs(game.Workspace.Game.Buttons:GetChildren()) do
        if v.Name == LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                for i,v3 in pairs(v2:GetChildren()) do
                    if v3:IsA("ObjectValue") then
                        v3.Name = v3.Value.Name
                    end
                end
            end
        end
    end
    
    wait(0.1)
    
    local buildingTypes = {
        ["Barracks"] = {"Barracks", "2"},
        ["Greenhouse"] = {"Greenhouse", "2"},
        ["Factory"] = {"Factory", "3"},
        ["Oil Field"] = {"Oil Field", "2"},
        ["Guard Tower"] = {"Guard Tower", "1"},
        ["Wall"] = {"Wall", "2"},
        ["Generator Powerplant"] = {"Generator Powerplant", "1"},
        ["Missile Factory"] = {"Missile Factory", "1"},
        ["Command Center"] = {"Command Center", "2"},
        ["Drone Factory"] = {"Drone Factory", "1"},
        ["Nuclear Powerplant"] = {"Nuclear Powerplant", "1"},
        ["Airport"] = {"Airport", "1"},
        ["Helicopter Bay"] = {"Helicopter Bay", "2"},
        ["Main Base"] = {"Main Base", "2"}
    }
    
    for i,v in pairs(game.Workspace.Game.Buttons:GetChildren()) do
        if v.Name == LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                for i,v3 in pairs(v2:GetChildren()) do
                    if v3:IsA("ObjectValue") then
                        local buildingName = v3.Name
                        if buildingName == "Military" then
                            local Class = ReplicatedStorage.Game.Buildings.Military["Tank Factory"]["2"]
                            ReplicatedStorage.RE.insertBuilding:FireServer(Class, v2)
                        elseif buildingTypes[buildingName] then
                            local buildingData = buildingTypes[buildingName]
                            local Class = ReplicatedStorage.Game.Buildings[buildingData[1]][buildingData[2]]
                            ReplicatedStorage.RE.insertBuilding:FireServer(Class, v2)
                        end
                    end
                end
            end
        end
    end
end

-- x4 Units Function
local function spawnX4Units()
    if not x4UnitsEnabled then return end
    
    spawn(function()
        while x4UnitsEnabled do
            wait(1)
            
            for i,v in pairs(game.Workspace.Game.Buildings:GetChildren()) do
                if v.Name == LocalPlayer.Name then
                    for i,v2 in pairs(v:GetChildren()) do
                        if v2.Name == "Barracks" and v2:FindFirstChild("Spawn") then
                            for i = 1, 4 do
                                ReplicatedStorage.RE.spawnUnit:FireServer("Soldier", v2.Spawn)
                                wait(0.1)
                            end
                        end
                    end
                end
            end
        end
    end)
end

-- More Unit +100 Function
local function spawnMoreUnits100()
    if isSpawning100Units then
        StatusLabel.Text = "⚠️ Already spawning units, please wait..."
        StatusLabel.TextColor3 = Color3.fromRGB(255, 204, 0)
        return
    end
    
    isSpawning100Units = true
    StatusLabel.Text = "🔥 Spawning 100 units... Please wait"
    StatusLabel.TextColor3 = Color3.fromRGB(255, 149, 0)
    MoreUnit100Button.Text = "🔥 Spawning..."
    MoreUnit100Button.BackgroundColor3 = Color3.fromRGB(142, 142, 147)
    
    spawn(function()
        local unitsSpawned = 0
        local maxUnits = 100
        
        local barracks = {}
        for i,v in pairs(game.Workspace.Game.Buildings:GetChildren()) do
            if v.Name == LocalPlayer.Name then
                for i,v2 in pairs(v:GetChildren()) do
                    if v2.Name == "Barracks" and v2:FindFirstChild("Spawn") then
                        table.insert(barracks, v2)
                    end
                end
            end
        end
        
        if #barracks == 0 then
            StatusLabel.Text = "❌ No barracks found! Build barracks first"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 59, 48)
            isSpawning100Units = false
            MoreUnit100Button.Text = "🔥 More Unit +100"
            MoreUnit100Button.BackgroundColor3 = Color3.fromRGB(255, 45, 85)
            return
        end
        
        while unitsSpawned < maxUnits do
            for _, barrack in pairs(barracks) do
                if unitsSpawned >= maxUnits then break end
                
                local unitTypes = {"Soldier", "Heavy Soldier", "Sniper", "Medic"}
                local randomUnit = unitTypes[math.random(1, #unitTypes)]
                
                pcall(function()
                    ReplicatedStorage.RE.spawnUnit:FireServer(randomUnit, barrack.Spawn)
                end)
                
                unitsSpawned = unitsSpawned + 1
                StatusLabel.Text = "🔥 Spawned: " .. unitsSpawned .. "/100 units"
                
                wait(0.05)
            end
        end
        
        StatusLabel.Text = "✅ Successfully spawned 100 units!"
        StatusLabel.TextColor3 = Color3.fromRGB(52, 199, 89)
        MoreUnit100Button.Text = "🔥 More Unit +100"
        MoreUnit100Button.BackgroundColor3 = Color3.fromRGB(255, 45, 85)
        isSpawning100Units = false
        
        wait(5)
        StatusLabel.Text = "✅ Ready to spawn units"
        StatusLabel.TextColor3 = Color3.fromRGB(52, 199, 89)
    end)
end

-- Nuke All Player Bases Function
local function nukeAllPlayerBases()
    local basesNuked = 0
    local playersTargeted = {}
    
    -- Update status
    StatusLabel.Text = "💥 Nuking all player bases..."
    StatusLabel.TextColor3 = Color3.fromRGB(255, 149, 0)
    NukeAllBasesButton.Text = "💥 Nuking..."
    NukeAllBasesButton.BackgroundColor3 = Color3.fromRGB(142, 142, 147)
    
    spawn(function()
        -- Find all player buildings and nuke them
        for i,v in pairs(game.Workspace.Game.Buildings:GetChildren()) do
            if v.Name ~= LocalPlayer.Name then -- Don't nuke own buildings
                local playerName = v.Name
                if not playersTargeted[playerName] then
                    playersTargeted[playerName] = true
                end
                
                -- Nuke each building of other players
                for i,v2 in pairs(v:GetChildren()) do
                    if v2:FindFirstChild("PrimaryPart") or v2:FindFirstChild("HumanoidRootPart") then
                        local targetPos = v2:FindFirstChild("PrimaryPart") and v2.PrimaryPart.Position or v2.HumanoidRootPart.Position
                        
                        pcall(function()
                            ReplicatedStorage.RE.FireMissile:FireServer("Nuke", targetPos)
                            basesNuked = basesNuked + 1
                            StatusLabel.Text = "💥 Nuked " .. basesNuked .. " buildings..."
                        end)
                        
                        wait(0.2) -- Small delay between nukes
                    elseif v2.Position then
                        -- For buildings without specific parts, use their position
                        pcall(function()
                            ReplicatedStorage.RE.FireMissile:FireServer("Nuke", v2.Position)
                            basesNuked = basesNuked + 1
                            StatusLabel.Text = "💥 Nuked " .. basesNuked .. " buildings..."
                        end)
                        
                        wait(0.2)
                    end
                end
            end
        end
        
        -- Also target main bases/spawn points
        for i,v in pairs(game.Workspace.Game.Buttons:GetChildren()) do
            if v.Name ~= LocalPlayer.Name then
                for i,v2 in pairs(v:GetChildren()) do
                    if v2.Position then
                        pcall(function()
                            ReplicatedStorage.RE.FireMissile:FireServer("Nuke", Vector3.new(v2.Position.X, v2.Position.Y + 10, v2.Position.Z))
                            basesNuked = basesNuked + 1
                        end)
                        wait(0.3)
                    end
                end
            end
        end
        
        -- Count targeted players
        local playerCount = 0
        for _ in pairs(playersTargeted) do
            playerCount = playerCount + 1
        end
        
        -- Completion message
        StatusLabel.Text = "✅ Nuked " .. basesNuked .. " buildings from " .. playerCount .. " players!"
        StatusLabel.TextColor3 = Color3.fromRGB(52, 199, 89)
        NukeAllBasesButton.Text = "💥 Nuke All Player Bases"
        NukeAllBasesButton.BackgroundColor3 = Color3.fromRGB(255, 20, 20)
        
        -- Reset status after 8 seconds
        wait(8)
        StatusLabel.Text = "✅ Ready to spawn units"
        StatusLabel.TextColor3 = Color3.fromRGB(52, 199, 89)
    end)
end

-- Event Connections (same as original)
MinimizeButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    MinimizedFrame.Visible = true
end)

RestoreButton.MouseButton1Click:Connect(function()
    MinimizedFrame.Visible = false
    MainFrame.Visible = true
end)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

PlayerDropdown.MouseButton1Click:Connect(function()
    playerDropdownOpen = not playerDropdownOpen
    PlayerList.Visible = playerDropdownOpen
    if playerDropdownOpen then
        updatePlayerList()
    end
end)

-- All button connections remain the same...
KillAllUnitsButton.MouseButton1Click:Connect(function()
    for i,v in pairs(game.Workspace.Game.Units:GetChildren()) do
        if v.Name ~= LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                if v2:FindFirstChild("Torso") then
                    ReplicatedStorage.RE.FireMissile:FireServer("Cruise Missile", v2.Torso.Position)
                end
            end
        end
    end
end)

GetAllBuildingsButton.MouseButton1Click:Connect(function()
    getAllBuildings()
end)

AutoRebirthButton.MouseButton1Click:Connect(function()
    autoRebirthEnabled = not autoRebirthEnabled
    if autoRebirthEnabled then
        AutoRebirthButton.Text = "🔄 Auto Rebirth: ON"
        AutoRebirthButton.BackgroundColor3 = Color3.fromRGB(52, 199, 89)
        
        spawn(function()
            while autoRebirthEnabled do
                wait(30)
                if autoRebirthEnabled then
                    getAllBuildings()
                end
            end
        end)
    else
        AutoRebirthButton.Text = "🔄 Auto Rebirth: OFF"
        AutoRebirthButton.BackgroundColor3 = Color3.fromRGB(142, 142, 147)
    end
end)

X4UnitsButton.MouseButton1Click:Connect(function()
    x4UnitsEnabled = not x4UnitsEnabled
    if x4UnitsEnabled then
        X4UnitsButton.Text = "⚡ x4 Units: ON"
        X4UnitsButton.BackgroundColor3 = Color3.fromRGB(52, 199, 89)
        spawnX4Units()
    else
        X4UnitsButton.Text = "⚡ x4 Units: OFF"
        X4UnitsButton.BackgroundColor3 = Color3.fromRGB(175, 82, 222)
    end
end)

MoreUnit100Button.MouseButton1Click:Connect(function()
    spawnMoreUnits100()
end)

NukePlayerButton.MouseButton1Click:Connect(function()
    if selectedPlayer and selectedPlayer.Character and selectedPlayer.Character:FindFirstChild("HumanoidRootPart") then
        ReplicatedStorage.RE.FireMissile:FireServer("Nuke", selectedPlayer.Character.HumanoidRootPart.Position)
    end
end)

KillPlayerUnitsButton.MouseButton1Click:Connect(function()
    if selectedPlayer then
        for i,v in pairs(game.Workspace.Game.Units:GetChildren()) do
            if v.Name == selectedPlayer.Name then
                for i,v2 in pairs(v:GetChildren()) do
                    if v2:FindFirstChild("Torso") then
                        ReplicatedStorage.RE.FireMissile:FireServer("Cruise Missile", v2.Torso.Position)
                    end
                end
            end
        end
    end
end)

NukeMouseButton.MouseButton1Click:Connect(function()
    local mouse = LocalPlayer:GetMouse()
    
    local connection
    connection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == Enum.KeyCode.Q then
            ReplicatedStorage.RE.FireMissile:FireServer("Nuke", Vector3.new(mouse.Hit.Position.X, 48.6649132, mouse.Hit.Position.Z))
        end
    end)
    
    NukeMouseButton.connection = connection
end)

NukeAllBasesButton.MouseButton1Click:Connect(function()
    nukeAllPlayerBases()
end)

-- Hide player list when clicking elsewhere
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.UserInputType == Enum.UserInputType.MouseButton1 and PlayerList.Visible then
        local mouse = LocalPlayer:GetMouse()
        local target = mouse.Target
        
        if not target or not target:IsDescendantOf(PlayerList) and target ~= PlayerDropdown then
            PlayerList.Visible = false
            playerDropdownOpen = false
        end
    end
end)

-- Update player list when players join/leave
Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)

print("💻 Developer GUI by @riee loaded successfully!")
print("✨ Modern Features:")
print("   - Ultra-modern UI design with gradients")
print("   - Enhanced visual effects and animations") 
print("   - Improved button styling with hover effects")
print("   - Professional color scheme")
print("   - Smooth dragging system")
print("   - 💥 NEW: Nuke All Player Bases feature!")
print("   - All original functionality preserved")
