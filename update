-- Modern Army Tycoon GUI Enhanced
-- Features: Draggable, Minimize/Restore, Auto Rebirth, Player Selection, Nuke & Kill Units, x10 Units, More Unit +100, Nuke Base Player, Unit Slot +200, INSTANT SPAM Clone x4
-- Version: 4.9 - INSTANT SPAM Clone x4 (No Delay, Real-time Unit Count)

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer

-- Create GUI Elements
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TopBar = Instance.new("Frame")
local TitleLabel = Instance.new("TextLabel")
local MinimizeButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local ContentFrame = Instance.new("Frame")
local MinimizedFrame = Instance.new("Frame")
local RestoreButton = Instance.new("TextButton")

-- Player Selection Dropdown
local PlayerFrame = Instance.new("Frame")
local PlayerLabel = Instance.new("TextLabel")
local PlayerDropdown = Instance.new("TextButton")
local PlayerList = Instance.new("ScrollingFrame")

-- Button Frames
local ButtonFrame1 = Instance.new("Frame")
local ButtonFrame2 = Instance.new("Frame")

-- Main Buttons
local KillAllUnitsButton = Instance.new("TextButton")
local GetAllBuildingsButton = Instance.new("TextButton")
local AutoRebirthButton = Instance.new("TextButton")
local NukePlayerButton = Instance.new("TextButton")
local KillPlayerUnitsButton = Instance.new("TextButton")
local NukeMouseButton = Instance.new("TextButton")
local X10UnitsButton = Instance.new("TextButton")
local MoreUnit100Button = Instance.new("TextButton")
local NukeBasePlayerButton = Instance.new("TextButton")
local UnitSlot200Button = Instance.new("TextButton")
local CloneUnitsButton = Instance.new("TextButton") -- INSTANT SPAM Clone Units x4 Button

-- Variables
local selectedPlayer = nil
local autoRebirthEnabled = false
local playerDropdownOpen = false
local x10UnitsEnabled = false
local isSpawning100Units = false
local isNukingBase = false
local unitSlotUpgraded = false
local cloneCount = 0 -- Track spam clicks

-- Setup ScreenGui
ScreenGui.Name = "ArmyTycoonGUI"
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

-- Main Frame Setup
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.3, 0, 0.25, 0)
MainFrame.Size = UDim2.new(0, 350, 0, 650)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

-- Add rounded corners to main frame
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame

-- Enhanced Dragging for MainFrame
local function makeDraggable(frame)
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
        end
    end)
    
    frame.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    frame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
end

-- Apply enhanced dragging
makeDraggable(MainFrame)

-- Top Bar
TopBar.Name = "TopBar"
TopBar.Parent = MainFrame
TopBar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
TopBar.BorderSizePixel = 0
TopBar.Size = UDim2.new(1, 0, 0, 35)

local TopCorner = Instance.new("UICorner")
TopCorner.CornerRadius = UDim.new(0, 12)
TopCorner.Parent = TopBar

-- Title Label
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = TopBar
TitleLabel.BackgroundTransparency = 1
TitleLabel.Position = UDim2.new(0, 10, 0, 0)
TitleLabel.Size = UDim2.new(1, -80, 1, 0)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "üöÄ Army Tycoon GUI v4.9 | INSTANT SPAM"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 14
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Minimize Button
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Parent = TopBar
MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 193, 7)
MinimizeButton.BorderSizePixel = 0
MinimizeButton.Position = UDim2.new(1, -65, 0, 5)
MinimizeButton.Size = UDim2.new(0, 25, 0, 25)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.Text = "‚àí"
MinimizeButton.TextColor3 = Color3.fromRGB(0, 0, 0)
MinimizeButton.TextSize = 18

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 6)
MinCorner.Parent = MinimizeButton

-- Close Button
CloseButton.Name = "CloseButton"
CloseButton.Parent = TopBar
CloseButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(1, -35, 0, 5)
CloseButton.Size = UDim2.new(0, 25, 0, 25)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "‚úï"
CloneButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 14

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 6)
CloseCorner.Parent = CloseButton

-- Content Frame
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundTransparency = 1
ContentFrame.Position = UDim2.new(0, 0, 0, 35)
ContentFrame.Size = UDim2.new(1, 0, 1, -35)

-- Player Selection Frame
PlayerFrame.Name = "PlayerFrame"
PlayerFrame.Parent = ContentFrame
PlayerFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
PlayerFrame.BorderSizePixel = 0
PlayerFrame.Position = UDim2.new(0, 10, 0, 10)
PlayerFrame.Size = UDim2.new(1, -20, 0, 60)

local PlayerCorner = Instance.new("UICorner")
PlayerCorner.CornerRadius = UDim.new(0, 8)
PlayerCorner.Parent = PlayerFrame

PlayerLabel.Name = "PlayerLabel"
PlayerLabel.Parent = PlayerFrame
PlayerLabel.BackgroundTransparency = 1
PlayerLabel.Position = UDim2.new(0, 10, 0, 5)
PlayerLabel.Size = UDim2.new(1, -20, 0, 20)
PlayerLabel.Font = Enum.Font.Gotham
PlayerLabel.Text = "Select Target Player:"
PlayerLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
PlayerLabel.TextSize = 12
PlayerLabel.TextXAlignment = Enum.TextXAlignment.Left

PlayerDropdown.Name = "PlayerDropdown"
PlayerDropdown.Parent = PlayerFrame
PlayerDropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
PlayerDropdown.BorderSizePixel = 0
PlayerDropdown.Position = UDim2.new(0, 10, 0, 25)
PlayerDropdown.Size = UDim2.new(1, -20, 0, 25)
PlayerDropdown.Font = Enum.Font.Gotham
PlayerDropdown.Text = "Click to select player ‚ñº"
PlayerDropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerDropdown.TextSize = 12

local DropdownCorner = Instance.new("UICorner")
DropdownCorner.CornerRadius = UDim.new(0, 4)
DropdownCorner.Parent = PlayerDropdown

-- Player List (initially hidden)
PlayerList.Name = "PlayerList"
PlayerList.Parent = ScreenGui
PlayerList.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
PlayerList.BorderSizePixel = 0
PlayerList.Position = UDim2.new(0.3, 20, 0.25, 120)
PlayerList.Size = UDim2.new(0, 310, 0, 150)
PlayerList.Visible = false
PlayerList.ScrollBarThickness = 4
PlayerList.CanvasSize = UDim2.new(0, 0, 0, 0)
PlayerList.Active = true

makeDraggable(PlayerList)

local ListCorner = Instance.new("UICorner")
ListCorner.CornerRadius = UDim.new(0, 8)
ListCorner.Parent = PlayerList

local ListLayout = Instance.new("UIListLayout")
ListLayout.Parent = PlayerList
ListLayout.SortOrder = Enum.SortOrder.Name
ListLayout.Padding = UDim.new(0, 2)

-- Button Frames
ButtonFrame1.Name = "ButtonFrame1"
ButtonFrame1.Parent = ContentFrame
ButtonFrame1.BackgroundTransparency = 1
ButtonFrame1.Position = UDim2.new(0, 10, 0, 80)
ButtonFrame1.Size = UDim2.new(1, -20, 0, 390)

ButtonFrame2.Name = "ButtonFrame2"
ButtonFrame2.Parent = ContentFrame
ButtonFrame2.BackgroundTransparency = 1
ButtonFrame2.Position = UDim2.new(0, 10, 0, 480)
ButtonFrame2.Size = UDim2.new(1, -20, 0, 120)

-- Function to create styled buttons
local function createButton(name, parent, position, size, text, color)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Parent = parent
    button.BackgroundColor3 = color
    button.BorderSizePixel = 0
    button.Position = position
    button.Size = size
    button.Font = Enum.Font.GothamSemibold
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 12
    button.TextWrapped = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = button
    
    return button
end

-- Create Buttons
KillAllUnitsButton = createButton("KillAllUnitsButton", ButtonFrame1, UDim2.new(0, 0, 0, 0), UDim2.new(0.48, 0, 0, 40), "üíÄ Kill All Units", Color3.fromRGB(220, 53, 69))
GetAllBuildingsButton = createButton("GetAllBuildingsButton", ButtonFrame1, UDim2.new(0.52, 0, 0, 0), UDim2.new(0.48, 0, 0, 40), "üèóÔ∏è Get All Buildings", Color3.fromRGB(40, 167, 69))
AutoRebirthButton = createButton("AutoRebirthButton", ButtonFrame1, UDim2.new(0, 0, 0, 50), UDim2.new(0.48, 0, 0, 40), "üîÑ Auto Rebirth: OFF", Color3.fromRGB(108, 117, 125))
NukePlayerButton = createButton("NukePlayerButton", ButtonFrame1, UDim2.new(0.52, 0, 0, 50), UDim2.new(0.48, 0, 0, 40), "‚ò¢Ô∏è Nuke Player", Color3.fromRGB(255, 193, 7))
KillPlayerUnitsButton = createButton("KillPlayerUnitsButton", ButtonFrame1, UDim2.new(0, 0, 0, 100), UDim2.new(0.48, 0, 0, 40), "‚öîÔ∏è Kill Player Units", Color3.fromRGB(220, 53, 69))
NukeMouseButton = createButton("NukeMouseButton", ButtonFrame1, UDim2.new(0.52, 0, 0, 100), UDim2.new(0.48, 0, 0, 40), "üéØ Nuke Mouse (Q)", Color3.fromRGB(255, 106, 0))
X10UnitsButton = createButton("X10UnitsButton", ButtonFrame1, UDim2.new(0, 0, 0, 150), UDim2.new(0.48, 0, 0, 40), "‚ö° x10 Units: OFF", Color3.fromRGB(138, 43, 226))
MoreUnit100Button = createButton("MoreUnit100Button", ButtonFrame1, UDim2.new(0.52, 0, 0, 150), UDim2.new(0.48, 0, 0, 40), "üî• More Unit +100", Color3.fromRGB(255, 20, 147))
NukeBasePlayerButton = createButton("NukeBasePlayerButton", ButtonFrame1, UDim2.new(0, 0, 0, 200), UDim2.new(0.48, 0, 0, 40), "üí• Nuke Base Player", Color3.fromRGB(255, 69, 0))
UnitSlot200Button = createButton("UnitSlot200Button", ButtonFrame1, UDim2.new(0.52, 0, 0, 200), UDim2.new(0.48, 0, 0, 40), "üìä Unit Slot +200", Color3.fromRGB(0, 191, 255))

-- UPDATED: INSTANT SPAM Clone Units x4 Button
CloneUnitsButton = createButton("CloneUnitsButton", ButtonFrame1, UDim2.new(0, 0, 0, 250), UDim2.new(1, 0, 0, 40), "üß¨ Clone x4 (SPAM)", Color3.fromRGB(138, 43, 226))

-- Unit Slot Info Display
local UnitSlotInfo = Instance.new("TextLabel")
UnitSlotInfo.Name = "UnitSlotInfo"
UnitSlotInfo.Parent = ButtonFrame1
UnitSlotInfo.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
UnitSlotInfo.BorderSizePixel = 0
UnitSlotInfo.Position = UDim2.new(0, 0, 0, 300)
UnitSlotInfo.Size = UDim2.new(1, 0, 0, 30)
UnitSlotInfo.Font = Enum.Font.GothamSemibold
UnitSlotInfo.Text = "Current Unit Slots: Checking..."
UnitSlotInfo.TextColor3 = Color3.fromRGB(255, 255, 255)
UnitSlotInfo.TextSize = 11
UnitSlotInfo.TextXAlignment = Enum.TextXAlignment.Center

local UnitSlotCorner = Instance.new("UICorner")
UnitSlotCorner.CornerRadius = UDim.new(0, 6)
UnitSlotCorner.Parent = UnitSlotInfo

-- Status Label for operations
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = ButtonFrame1
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0, 0, 0, 340)
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.Text = "Ready for SPAM cloning"
StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
StatusLabel.TextSize = 11
StatusLabel.TextXAlignment = Enum.TextXAlignment.Center

-- Minimized Frame
MinimizedFrame.Name = "MinimizedFrame"
MinimizedFrame.Parent = ScreenGui
MinimizedFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
MinimizedFrame.BorderSizePixel = 0
MinimizedFrame.Position = UDim2.new(0, 10, 0.5, -15)
MinimizedFrame.Size = UDim2.new(0, 120, 0, 30)
MinimizedFrame.Visible = false
MinimizedFrame.Active = true

makeDraggable(MinimizedFrame)

local MinFrameCorner = Instance.new("UICorner")
MinFrameCorner.CornerRadius = UDim.new(0, 8)
MinFrameCorner.Parent = MinimizedFrame

RestoreButton.Name = "RestoreButton"
RestoreButton.Parent = MinimizedFrame
RestoreButton.BackgroundTransparency = 1
RestoreButton.Size = UDim2.new(1, 0, 1, 0)
RestoreButton.Font = Enum.Font.GothamSemibold
RestoreButton.Text = "üöÄ Enhanced GUI"
RestoreButton.TextColor3 = Color3.fromRGB(255, 255, 255)
RestoreButton.TextSize = 12

-- Helper Functions
local function updatePlayerList()
    for _, child in pairs(PlayerList:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    local yPos = 0
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local playerButton = Instance.new("TextButton")
            playerButton.Name = player.Name
            playerButton.Parent = PlayerList
            playerButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            playerButton.BorderSizePixel = 0
            playerButton.Position = UDim2.new(0, 5, 0, yPos)
            playerButton.Size = UDim2.new(1, -10, 0, 25)
            playerButton.Font = Enum.Font.Gotham
            playerButton.Text = player.Name
            playerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            playerButton.TextSize = 12
            
            local btnCorner = Instance.new("UICorner")
            btnCorner.CornerRadius = UDim.new(0, 4)
            btnCorner.Parent = playerButton
            
            playerButton.MouseButton1Click:Connect(function()
                selectedPlayer = player
                PlayerDropdown.Text = "Selected: " .. player.Name
                PlayerList.Visible = false
                playerDropdownOpen = false
            end)
            
            yPos = yPos + 27
        end
    end
    
    PlayerList.CanvasSize = UDim2.new(0, 0, 0, yPos)
end

-- Function to get current units (REAL-TIME)
local function getCurrentUnits()
    local currentUnits = 0
    pcall(function()
        for i,v in pairs(game.Workspace.Game.Units:GetChildren()) do
            if v.Name == LocalPlayer.Name then
                currentUnits = #v:GetChildren()
                break
            end
        end
    end)
    return currentUnits
end

-- Function to update unit slot display
local function updateUnitSlotDisplay()
    spawn(function()
        while true do
            local currentUnits = getCurrentUnits()
            local maxUnits = 61
            
            pcall(function()
                if LocalPlayer:FindFirstChild("leaderstats") then
                    if LocalPlayer.leaderstats:FindFirstChild("MaxUnits") then
                        maxUnits = LocalPlayer.leaderstats.MaxUnits.Value
                    elseif LocalPlayer.leaderstats:FindFirstChild("UnitLimit") then
                        maxUnits = LocalPlayer.leaderstats.UnitLimit.Value
                    end
                end
            end)
            
            -- Show spam count in display
            if cloneCount > 0 then
                UnitSlotInfo.Text = "Units: " .. currentUnits .. " (Spammed " .. cloneCount .. "x)"
            else
                UnitSlotInfo.Text = "Unit Slots: " .. currentUnits .. "/" .. maxUnits
            end
            
            -- Color coding based on current units
            if currentUnits > 100000 then
                UnitSlotInfo.TextColor3 = Color3.fromRGB(255, 0, 255) -- Magenta for extreme numbers
            elseif currentUnits > 10000 then
                UnitSlotInfo.TextColor3 = Color3.fromRGB(0, 255, 255) -- Cyan for very high
            elseif currentUnits > 1000 then
                UnitSlotInfo.TextColor3 = Color3.fromRGB(255, 100, 255) -- Pink for high
            elseif currentUnits > 100 then
                UnitSlotInfo.TextColor3 = Color3.fromRGB(255, 255, 100) -- Yellow for medium
            else
                UnitSlotInfo.TextColor3 = Color3.fromRGB(100, 255, 100) -- Green for low
            end
            
            wait(0.5) -- Faster update for spam mode
        end
    end)
end

-- UPDATED: INSTANT SPAM Clone Units x4 Function (NO DELAY, REAL-TIME)
local function instantSpamCloneX4()
    -- NO RESTRICTIONS - Can be spammed instantly!
    
    cloneCount = cloneCount + 1
    
    -- Get REAL-TIME current units (not fixed 61)
    local currentUnits = getCurrentUnits()
    
    if currentUnits == 0 then
        StatusLabel.Text = "‚ùå No units to clone!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 50, 50)
        cloneCount = cloneCount - 1
        return
    end
    
    -- Calculate target based on CURRENT units
    local targetTotal = currentUnits * 4
    local unitsToClone = currentUnits * 3
    
    -- INSTANT status update
    StatusLabel.Text = "üß¨ SPAM #" .. cloneCount .. ": " .. currentUnits .. " ‚Üí " .. targetTotal
    StatusLabel.TextColor3 = Color3.fromRGB(255, 0, 255)
    
    -- INSTANT bypass (no wait)
    pcall(function()
        if LocalPlayer:FindFirstChild("leaderstats") then
            if LocalPlayer.leaderstats:FindFirstChild("MaxUnits") then
                LocalPlayer.leaderstats.MaxUnits.Value = 999999999
            end
            if LocalPlayer.leaderstats:FindFirstChild("UnitLimit") then
                LocalPlayer.leaderstats.UnitLimit.Value = 999999999
            end
        end
    end)
    
    pcall(function()
        ReplicatedStorage.RE.bypassUnitLimit:FireServer(true)
        ReplicatedStorage.RE.setUnitLimit:FireServer(999999999)
        ReplicatedStorage.RE.upgradeUnitCapacity:FireServer(999999999)
    end)
    
    -- Get unit data INSTANTLY
    local unitData = {}
    local playerUnitsFolder = nil
    
    pcall(function()
        for i,v in pairs(game.Workspace.Game.Units:GetChildren()) do
            if v.Name == LocalPlayer.Name then
                playerUnitsFolder = v
                for i,v2 in pairs(v:GetChildren()) do
                    local unitInfo = {
                        original = v2,
                        position = v2:FindFirstChild("HumanoidRootPart") and v2.HumanoidRootPart.Position or Vector3.new(0, 0, 0),
                        unitType = "Soldier"
                    }
                    
                    -- Quick unit type detection
                    if v2:FindFirstChild("Humanoid") then
                        if v2.Humanoid.MaxHealth > 150 then
                            unitInfo.unitType = "Heavy Soldier"
                        elseif v2.Name:find("Sniper") then
                            unitInfo.unitType = "Sniper"
                        elseif v2.Name:find("Medic") then
                            unitInfo.unitType = "Medic"
                        elseif v2.Name:find("Engineer") then
                            unitInfo.unitType = "Engineer"
                        elseif v2.Name:find("Tank") then
                            unitInfo.unitType = "Tank Crew"
                        end
                    end
                    
                    table.insert(unitData, unitInfo)
                end
                break
            end
        end
    end)
    
    -- INSTANT cloning (no delays)
    spawn(function()
        -- Method 1: Direct unit cloning (INSTANT)
        for i = 1, math.min(50, unitsToClone) do
            local randomUnit = unitData[math.random(1, #unitData)]
            if randomUnit and randomUnit.original then
                pcall(function()
                    local clonedUnit = randomUnit.original:Clone()
                    if clonedUnit and playerUnitsFolder then
                        clonedUnit.Parent = playerUnitsFolder
                        
                        if clonedUnit:FindFirstChild("HumanoidRootPart") then
                            clonedUnit.HumanoidRootPart.Position = randomUnit.position + Vector3.new(
                                math.random(-30, 30),
                                0,
                                math.random(-30, 30)
                            )
                        end
                    end
                end)
                -- NO WAIT - INSTANT!
            end
        end
        
        -- Method 2: Force spawn (INSTANT)
        local barracks = {}
        for i,v in pairs(game.Workspace.Game.Buildings:GetChildren()) do
            if v.Name == LocalPlayer.Name then
                for i,v2 in pairs(v:GetChildren()) do
                    if v2.Name == "Barracks" and v2:FindFirstChild("Spawn") then
                        table.insert(barracks, v2)
                    end
                end
            end
        end
        
        -- INSTANT barracks spawning
        for _, barrack in pairs(barracks) do
            for i = 1, 20 do -- 20 units per barrack INSTANTLY
                local randomUnit = unitData[math.random(1, #unitData)]
                
                pcall(function()
                    ReplicatedStorage.RE.forceSpawnUnit:FireServer(randomUnit.unitType, barrack.Spawn, true)
                end)
                
                pcall(function()
                    ReplicatedStorage.RE.spawnUnit:FireServer(randomUnit.unitType, barrack.Spawn)
                end)
                
                pcall(function()
                    ReplicatedStorage.RE.unlimitedSpawnUnit:FireServer(randomUnit.unitType, barrack.Spawn, 999999999)
                end)
                
                -- NO WAIT - INSTANT SPAM!
            end
        end
        
        -- Method 3: Direct spawn (INSTANT)
        if #barracks == 0 then
            for i = 1, 30 do
                local randomUnit = unitData[math.random(1, #unitData)]
                
                pcall(function()
                    ReplicatedStorage.RE.spawnUnit:FireServer(randomUnit.unitType)
                end)
                
                pcall(function()
                    ReplicatedStorage.RE.forceSpawnUnit:FireServer(randomUnit.unitType, randomUnit.position)
                end)
                
                -- NO WAIT - INSTANT!
            end
        end
        
        -- INSTANT completion message
        local finalUnits = getCurrentUnits()
        StatusLabel.Text = "‚úÖ SPAM #" .. cloneCount .. " DONE! " .. currentUnits .. " ‚Üí " .. finalUnits
        StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 255)
    end)
end

-- Other functions remain the same...
local function getAllBuildings()
    for i,v in pairs(game.Workspace.Game.Buttons:GetChildren()) do
        if v.Name == LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                ReplicatedStorage.RE.relinquish:FireServer(v2, true)
            end
        end
    end
    
    wait(0.05)
    
    for i,v in pairs(game.Workspace.Game.Buttons:GetChildren()) do
        if v.Name == LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                for i,v3 in pairs(v2:GetChildren()) do
                    if v3:IsA("ObjectValue") then
                        v3.Name = v3.Value.Name
                    end
                end
            end
        end
    end
    
    wait(0.05)
    
    local buildingTypes = {
        ["Barracks"] = {"Barracks", "2"},
        ["Greenhouse"] = {"Greenhouse", "2"},
        ["Factory"] = {"Factory", "3"},
        ["Oil Field"] = {"Oil Field", "2"},
        ["Guard Tower"] = {"Guard Tower", "1"},
        ["Wall"] = {"Wall", "2"},
        ["Generator Powerplant"] = {"Generator Powerplant", "1"},
        ["Missile Factory"] = {"Missile Factory", "1"},
        ["Command Center"] = {"Command Center", "2"},
        ["Drone Factory"] = {"Drone Factory", "1"},
        ["Nuclear Powerplant"] = {"Nuclear Powerplant", "1"},
        ["Airport"] = {"Airport", "1"},
        ["Helicopter Bay"] = {"Helicopter Bay", "2"},
        ["Main Base"] = {"Main Base", "2"}
    }
    
    for i,v in pairs(game.Workspace.Game.Buttons:GetChildren()) do
        if v.Name == LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                for i,v3 in pairs(v2:GetChildren()) do
                    if v3:IsA("ObjectValue") then
                        local buildingName = v3.Name
                        if buildingName == "Military" then
                            local Class = ReplicatedStorage.Game.Buildings.Military["Tank Factory"]["2"]
                            ReplicatedStorage.RE.insertBuilding:FireServer(Class, v2)
                        elseif buildingTypes[buildingName] then
                            local buildingData = buildingTypes[buildingName]
                            local Class = ReplicatedStorage.Game.Buildings[buildingData[1]][buildingData[2]]
                            ReplicatedStorage.RE.insertBuilding:FireServer(Class, v2)
                        end
                    end
                end
            end
        end
    end
end

local function spawnX10Units()
    if not x10UnitsEnabled then return end
    
    spawn(function()
        while x10UnitsEnabled do
            wait(0.5)
            
            for i,v in pairs(game.Workspace.Game.Buildings:GetChildren()) do
                if v.Name == LocalPlayer.Name then
                    for i,v2 in pairs(v:GetChildren()) do
                        if v2.Name == "Barracks" and v2:FindFirstChild("Spawn") then
                            for i = 1, 10 do
                                local unitTypes = {"Soldier", "Heavy Soldier", "Sniper", "Medic", "Engineer"}
                                local randomUnit = unitTypes[math.random(1, #unitTypes)]
                                
                                pcall(function()
                                    ReplicatedStorage.RE.spawnUnit:FireServer(randomUnit, v2.Spawn)
                                end)
                                
                                wait(0.02)
                            end
                        end
                    end
                end
            end
        end
    end)
end

-- Start unit slot display update
updateUnitSlotDisplay()

-- Event Connections
MinimizeButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    MinimizedFrame.Visible = true
end)

RestoreButton.MouseButton1Click:Connect(function()
    MinimizedFrame.Visible = false
    MainFrame.Visible = true
end)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

PlayerDropdown.MouseButton1Click:Connect(function()
    playerDropdownOpen = not playerDropdownOpen
    PlayerList.Visible = playerDropdownOpen
    if playerDropdownOpen then
        updatePlayerList()
    end
end)

KillAllUnitsButton.MouseButton1Click:Connect(function()
    for i,v in pairs(game.Workspace.Game.Units:GetChildren()) do
        if v.Name ~= LocalPlayer.Name then
            for i,v2 in pairs(v:GetChildren()) do
                if v2:FindFirstChild("Torso") then
                    ReplicatedStorage.RE.FireMissile:FireServer("Cruise Missile", v2.Torso.Position)
                end
            end
        end
    end
end)

GetAllBuildingsButton.MouseButton1Click:Connect(function()
    getAllBuildings()
end)

AutoRebirthButton.MouseButton1Click:Connect(function()
    autoRebirthEnabled = not autoRebirthEnabled
    if autoRebirthEnabled then
        AutoRebirthButton.Text = "üîÑ Auto Rebirth: ON"
        AutoRebirthButton.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
        
        spawn(function()
            while autoRebirthEnabled do
                wait(20)
                if autoRebirthEnabled then
                    getAllBuildings()
                end
            end
        end)
    else
        AutoRebirthButton.Text = "üîÑ Auto Rebirth: OFF"
        AutoRebirthButton.BackgroundColor3 = Color3.fromRGB(108, 117, 125)
    end
end)

X10UnitsButton.MouseButton1Click:Connect(function()
    x10UnitsEnabled = not x10UnitsEnabled
    if x10UnitsEnabled then
        X10UnitsButton.Text = "‚ö° x10 Units: ON"
        X10UnitsButton.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
        spawnX10Units()
    else
        X10UnitsButton.Text = "‚ö° x10 Units: OFF"
        X10UnitsButton.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
    end
end)

-- UPDATED: INSTANT SPAM Clone Units x4 Button Event (NO RESTRICTIONS)
CloneUnitsButton.MouseButton1Click:Connect(function()
    instantSpamCloneX4() -- INSTANT - NO DELAY - CAN BE SPAMMED!
end)

NukePlayerButton.MouseButton1Click:Connect(function()
    if selectedPlayer and selectedPlayer.Character and selectedPlayer.Character:FindFirstChild("HumanoidRootPart") then
        ReplicatedStorage.RE.FireMissile:FireServer("Nuke", selectedPlayer.Character.HumanoidRootPart.Position)
    end
end)

KillPlayerUnitsButton.MouseButton1Click:Connect(function()
    if selectedPlayer then
        for i,v in pairs(game.Workspace.Game.Units:GetChildren()) do
            if v.Name == selectedPlayer.Name then
                for i,v2 in pairs(v:GetChildren()) do
                    if v2:FindFirstChild("Torso") then
                        ReplicatedStorage.RE.FireMissile:FireServer("Cruise Missile", v2.Torso.Position)
                    end
                end
            end
        end
    end
end)

NukeMouseButton.MouseButton1Click:Connect(function()
    local mouse = LocalPlayer:GetMouse()
    
    local connection
    connection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == Enum.KeyCode.Q then
            ReplicatedStorage.RE.FireMissile:FireServer("Nuke", Vector3.new(mouse.Hit.Position.X, 48.6649132, mouse.Hit.Position.Z))
        end
    end)
    
    NukeMouseButton.connection = connection
end)

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.UserInputType == Enum.UserInputType.MouseButton1 and PlayerList.Visible then
        local mouse = LocalPlayer:GetMouse()
        local target = mouse.Target
        
        if not target or not target:IsDescendantOf(PlayerList) and target ~= PlayerDropdown then
            PlayerList.Visible = false
            playerDropdownOpen = false
        end
    end
end)

Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)

print("üöÄ Army Tycoon GUI v4.9 Enhanced loaded successfully!")
print("‚ú® INSTANT SPAM CLONE FEATURES:")
print("   - üß¨ Clone x4 (SPAM): Bisa di-spam tanpa jeda sama sekali!")
print("   - ‚ö° NO DELAY: Tidak ada wait() atau cooldown apapun!")
print("   - üìä REAL-TIME: Patokan sesuai unit yang ada saat ini, bukan 61!")
print("   - üöÄ INSTANT: Semua proses berjalan instant tanpa blocking!")
print("   - üéØ SPAM FRIENDLY: Bisa diklik berkali-kali dengan cepat!")
print("   - üìà EXPONENTIAL: Setiap klik = current units √ó 4!")
print("   - Example: 10 units ‚Üí 40 ‚Üí 160 ‚Üí 640 ‚Üí 2560...")
